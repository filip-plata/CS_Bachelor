next
next
next
next
next
next
next 10
next 10
next 10
next 10
next 10
next
next
p sp
p value
p token
p in
p out
next
next
next
next
p sp
p value
local info
info local
p token
p TOKEN_START
p token
p value
x/4xw $sp
x/4x $sp
x/40x $sp
x/80x $sp
c
x/80x $sp
b doit
r
c
b doit
run
bt
x/4xw $sp
x/44x $sp
b doit
c
r
b doit
r
b doit
r
x/50x $sp
step
step
step
step
step
step
step
x/50x $sp
p $ebp - 0xc
x/50x $ebp
p $ebp - 0xc
x/50x $ebp - 0x20
x/50x $ebp - 0x40
x/50x $ebp - 0x50
x/50x $ebp - 0x60
x/50x $ebp - 0x80
x/50x $ebp - 0x100
x/50x $ebp - 0x120
p value
p token
p $ebp - 0xc
p $ebp 
p $ebp - 0xc
frame
x/10x $sp
p $ebp - 0xc
p $ebp - 0x8c
x/10x $ebp -0x8c
step
step
step
step
step
step
step
step
step
step
step
step
step
step
step
step
step
step
step
step
step
step
step
step
step
step 10
step
step
step
step
step 10
step 4
step 4
step 4
step 4
step 4
step 4
x/10x $ebp -0x8c
x/80x $ebp -0x8c
p $ebp- 0xc
c
c
b doit
r
b doit
r
x/4xw $sp
x/4xw $esp
x/80x $esp
step
step 25
step 4
step 4
step 4
step 4
step 3
step 10
step 5
step 5
step 5
step 5
step 5
x/80x $ebp - 0x8c
info symbol 0xf7f92000
info symbol 0xffffce88
info symbol 0xf7fec4f0
info symbol 0xf7dd8899
c
c
c
c
c
set follow-fork-mode parent
b doit
b doit
r
c
b doit + 0xbf2
b doit + 0xbf2
p doit
b 0x565556cd + 0xbf2
b 0x565556cd + 0x00000bf2
step
step 50
step 30
step 20
next 50
)
next 20
next 10
0)
next
next
next
next
next
next
next
next
next
next
next
next
next
next
next
b doit
r
c
b doit+496
next 20
next 20
next 20
next 20
next 20
(((0))2))
(((0))2))
next 20
(
next 20
next 20
next 20
next 20
b fprintf
c
r
x/4xw $sp
x/80x $sp
p token
x/160x $sp
x/140x $sp
x/120x $sp
p token
x/160x $sp
c
set follow-fork-mode parent
b doit
c
r
p __libc_start_main
info symbol 0xf7dd8890
info symbol 0xf7dd8891
info symbol 0xf7dd8890
c
ropsearch "pop;pop;ret"
rop
rop --grep "pop; ret"
p doit
b doit
c
r
b 0x56555a24
b *0x56555a24
c
x/4xw $sp
x/4xw $esp
x/4x $esp
x/4x $ebp - 0x8c
x/50x $ebp - 0x8c
c
c
b doit
r
b *0x56555a24
c
x/4xw $ebp - 0x8c
x/20x $ebp - 0x8c
x/20x $ebp - 0x10c
x/20x $ebp - 0x8c
b *doit + 855
r
x/4x $ebp - 0x8c
x/8x $ebp - 0x8c
b *doit+855
r
 x/8x $ebp - 0x8c
